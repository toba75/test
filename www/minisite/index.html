<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StockGPT Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: #2c3e50;
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        
        header h1 {
            text-align: center;
            font-size: 2.5rem;
        }
        
        header p {
            text-align: center;
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .card {
            background: white;
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: #2c3e50;
            margin-bottom: 1rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
        }
        
        h3 {
            color: #34495e;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .metric-card {
            background: #ecf0f1;
            padding: 1rem;
            border-radius: 4px;
            text-align: center;
        }
        
        .metric-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
        }
        
        .metric-card .label {
            color: #7f8c8d;
            margin-top: 0.5rem;
        }
        
        footer {
            text-align: center;
            padding: 2rem;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>StockGPT</h1>
            <p>A GenAI Model for Stock Prediction and Trading</p>
        </div>
    </header>
    
    <div class="container">
        <div class="card">
            <h2>Overview</h2>
            <p>
                StockGPT is a transformer-based autoregressive model trained on daily stock returns.
                It uses a GPT-style decoder architecture to predict future returns by learning patterns
                from historical return sequences.
            </p>
            <p style="margin-top: 1rem;">
                The model discretizes continuous returns into 402 tokens using 50 basis point bins,
                enabling it to treat return prediction as a sequence classification task.
            </p>
        </div>
        
        <div class="card">
            <h2>Model Architecture</h2>
            <div class="metrics">
                <div class="metric-card">
                    <div class="value">256</div>
                    <div class="label">Sequence Length</div>
                </div>
                <div class="metric-card">
                    <div class="value">128</div>
                    <div class="label">Embedding Dimension</div>
                </div>
                <div class="metric-card">
                    <div class="value">4</div>
                    <div class="label">Transformer Layers</div>
                </div>
                <div class="metric-card">
                    <div class="value">~930K</div>
                    <div class="label">Parameters</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>Key Features</h2>
            <h3>Tokenization</h3>
            <ul>
                <li>50 basis points (bps) bins</li>
                <li>402 total tokens covering ±100% returns</li>
                <li>Closed-right intervals for precise discretization</li>
            </ul>
            
            <h3>Training</h3>
            <ul>
                <li>Cross-entropy loss over token vocabulary</li>
                <li>Mixed precision training (bfloat16)</li>
                <li>AdamW optimizer with cosine learning rate schedule</li>
                <li>Data: CRSP 1926-2023 (train: 1926-2000, test: 2001-2023)</li>
            </ul>
            
            <h3>Inference</h3>
            <ul>
                <li>Outputs probability distribution over 402 tokens</li>
                <li>Expected return via midpoint-weighted averaging</li>
                <li>Batch GPU inference for efficiency</li>
            </ul>
        </div>
        
        <div class="card">
            <h2>Portfolio Strategy</h2>
            <p>Daily rebalanced long-short strategy:</p>
            <ul>
                <li><strong>Long</strong>: Top 10% of stocks by predicted return</li>
                <li><strong>Short</strong>: Bottom 10% of stocks by predicted return</li>
                <li><strong>Weighting</strong>: Equal-weighted positions</li>
                <li><strong>Filters</strong>: Liquidity-based universe selection</li>
            </ul>
            
            <h3>Expected Performance (Reference)</h3>
            <p>From paper (market cap filter, equal-weighted):</p>
            <ul>
                <li>Annualized Return: ~119%</li>
                <li>Sharpe Ratio: ~6.5</li>
            </ul>
            <p style="margin-top: 0.5rem; color: #7f8c8d; font-size: 0.9rem;">
                Note: These are reference benchmarks from the paper. Actual performance varies with data,
                filters, and implementation details.
            </p>
        </div>
        
        <div class="card">
            <h2>Quick Start</h2>
            <h3>Installation</h3>
            <pre>git clone &lt;repository&gt;
cd stockgpt
make install</pre>
            
            <h3>Data Preparation</h3>
            <pre>python scripts/prepare_crsp.py --data-path ~/stockGPT/data --output prepared/returns.parquet</pre>
            
            <h3>Training</h3>
            <pre>python scripts/train_stockgpt.py --config configs/config.yaml --data prepared/returns.parquet</pre>
            
            <h3>Prediction</h3>
            <pre>python scripts/predict.py --checkpoint outputs/checkpoints/best_model.pt</pre>
            
            <h3>Backtesting</h3>
            <pre>python scripts/backtest_daily.py --predictions outputs/predictions.parquet</pre>
        </div>
        
        <div class="card">
            <h2>Documentation</h2>
            <ul>
                <li><strong>Methodology</strong>: <code>docs/README-methodo.md</code> - Complete protocol description</li>
                <li><strong>Reference Paper</strong>: <code>docs/ssrn-4787199.pdf</code> - Original StockGPT paper</li>
                <li><strong>Code</strong>: <code>src/stockgpt/</code> - Implementation source code</li>
                <li><strong>Tests</strong>: <code>tests/</code> - Unit and integration tests</li>
            </ul>
        </div>
        
        <div class="card">
            <h2>Project Structure</h2>
            <pre>stockgpt/
├── src/stockgpt/          # Main package
│   ├── dataio/            # Data I/O and schemas
│   ├── tokens/            # Return tokenization
│   ├── model/             # GPT architecture
│   ├── train/             # Training pipeline
│   ├── infer/             # Inference
│   ├── eval/              # Evaluation metrics
│   └── utils/             # Utilities
├── configs/               # Configuration files
├── scripts/               # CLI scripts
├── tests/                 # Unit tests
├── docs/                  # Documentation
└── www/minisite/          # This website</pre>
        </div>
        
        <div class="card">
            <h2>Citation</h2>
            <p>If you use this implementation, please cite:</p>
            <pre>Dat Mai (2025). "StockGPT: A GenAI Model for Stock Prediction and Trading"</pre>
        </div>
    </div>
    
    <footer>
        <p>StockGPT Implementation | For research and educational purposes</p>
    </footer>
</body>
</html>
